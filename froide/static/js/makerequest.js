!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.makerequest=factory():(root.Froide=root.Froide||{},root.Froide.components=root.Froide.components||{},root.Froide.components.makerequest=factory())}(this,function(){return webpackJsonpFroide_components__name_([1],{27:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var LetterMixin={computed:(Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target})({letterStart:function(){return this.defaultLaw?this.defaultLaw.letter_start+"\n":this.i18n.greeting+"\n\n"+this.i18n.defaultLetterStart+"\n"},letterSignatureName:function(){var name="";return(this.user.id||this.user.first_name||this.user.last_name)&&(name=(this.user.first_name||"")+" "+(this.user.last_name||"")),name.trim()},letterEndShort:function(){var name=this.letterSignatureName;return"[…]\n"+this.i18n.kindRegards+"\n"+name},letterEnd:function(){var name=this.letterSignatureName;return this.defaultLaw?this.defaultLaw.letter_end+"\n"+name:this.i18n.kindRegards+"\n"+name},letterEndNoName:function(){return this.defaultLaw?""+this.defaultLaw.letter_end:""+this.i18n.kindRegards},letterSignature:function(){return!(this.user.id||this.user.first_name||this.user.last_name)&&this.i18n.giveName}},(0,__webpack_require__(2).mapGetters)(["user","defaultLaw"]))};exports["default"]=LetterMixin},73:function(module,exports,__webpack_require__){module.exports=__webpack_require__(74)},74:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _vue2=_interopRequireDefault(__webpack_require__(9)),_store2=_interopRequireDefault(__webpack_require__(24)),_mutation_types=__webpack_require__(5),_requestForm2=_interopRequireDefault(__webpack_require__(75));_vue2["default"].config.productionTip=!1,module.exports={createRequestForm:function(selector,config){_store2["default"].commit(_mutation_types.SET_CONFIG,config),new _vue2["default"]({store:_store2["default"],data:{config:config},components:{RequestForm:_requestForm2["default"]},el:selector})}},exports["default"]=module.exports},75:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_request_form_vue__=__webpack_require__(78),__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_request_form_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_request_form_vue__),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4257ec88_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_request_form_vue__=__webpack_require__(90),Component=__webpack_require__(3)(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_request_form_vue___default.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4257ec88_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_request_form_vue__.a,!1,function(ssrContext){__webpack_require__(76)},"data-v-4257ec88",null);__webpack_exports__["default"]=Component.exports},76:function(module,exports,__webpack_require__){var content=__webpack_require__(77);"string"==typeof content&&(content=[[module.i,content,""]]),content.locals&&(module.exports=content.locals);__webpack_require__(8)("9208ae18",content,!0)},77:function(module,exports,__webpack_require__){(module.exports=__webpack_require__(6)(undefined)).push([module.i,".process-breadcrumbs-container[data-v-4257ec88]{background-color:#f5f5f5}.process-breadcrumbs[data-v-4257ec88]{margin-bottom:0;list-style-type:none;display:flex;flex-wrap:wrap}.process-breadcrumbs li[data-v-4257ec88]{flex:1;min-width:150px;padding:15px 0}.process-breadcrumbs li>[data-v-4257ec88],.process-breadcrumbs li [data-v-4257ec88]:hover{color:#adb5bd;text-decoration:none}.process-breadcrumbs li.active>[data-v-4257ec88]{color:#000;font-weight:700}.process-breadcrumbs li.done>[data-v-4257ec88]{color:#28a745}legend[data-v-4257ec88]{padding:2rem 0;font-size:2rem}.small a[data-v-4257ec88]{color:#0069d0}.request-hints[data-v-4257ec88]{color:#495057;font-size:.875rem}.request-hints ul[data-v-4257ec88]{padding-left:1rem}.publicbody-summary-container[data-v-4257ec88]{margin:0 0 2rem}.publicbody-summary[data-v-4257ec88]{font-size:1.25rem}.pb-change-link[data-v-4257ec88]{font-weight:400;font-size:.875rem}.body-text[data-v-4257ec88]{white-space:pre-wrap;word-wrap:break-word;color:#999}.body-textarea[data-v-4257ec88]{width:100%;padding-left:0;margin-left:-5px;padding:5px}.body-textarea.attention[data-v-4257ec88]{border-left:3px solid #faa}",""])},78:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_similarRequests2=_interopRequireDefault(__webpack_require__(79)),_publicbodyChooser2=_interopRequireDefault(__webpack_require__(26)),_userRegistration2=_interopRequireDefault(__webpack_require__(82)),_reviewRequest2=_interopRequireDefault(__webpack_require__(85)),_vuex=__webpack_require__(2),_mutation_types=__webpack_require__(5),_letterMixin2=_interopRequireDefault(__webpack_require__(27)),_i18nMixin2=_interopRequireDefault(__webpack_require__(16));exports["default"]={name:"request-form",props:["config","publicbodyDefaultSearch","publicbodyFormJson","publicbodiesJson","userJson","requestFormJson","userFormJson","showSimilar","showDraft","hidePublicbodyChooser","hideFullText","multiRequest"],mixins:[_i18nMixin2["default"],_letterMixin2["default"]],data:function(){return{bodyRows:3,originalBody:"",fullTextDisabled:!1}},created:function(){if(this.pbScope="make-request",this.updateSubject(this.form.subject.value||this.form.subject.initial||""),this.updateBody(this.form.body.value||this.form.body.initial||""),this.updateFullText(this.form.full_text.value||this.form.full_text.initial),this.userJson&&this.setUser(JSON.parse(this.userJson)),this.publicbodiesJson){var pbs=JSON.parse(this.publicbodiesJson);this.setPublicBodies({publicBodies:pbs,scope:this.pbScope}),this.cachePublicBodies(pbs)}},mounted:function(){var _this=this,step=_mutation_types.STEPS.SELECT_PUBLICBODY;this.hasPublicBodies&&(this.setStepRequest(),step=_mutation_types.STEPS.WRITE_REQUEST);var hash=_mutation_types.STEP_TO_URLS[step];window.history.pushState({step:step},"",hash),window.onpopstate=function(event){var hash=document.location.hash;_this.setStepByURL({hash:hash,scope:_this.pbScope})}},computed:_extends({nonFieldErrors:function(){return this._form.nonFieldErrors},_form:function(){return JSON.parse(this.requestFormJson)},form:function(){return this._form.fields},errors:function(){return this._form.errors},_userform:function(){return JSON.parse(this.userFormJson)},userform:function(){return this._userform.fields},usererrors:function(){return this._userform.errors},hasNotes:function(){return!!this.defaultLaw&&!!this.defaultLaw.request_note_html},requestNotes:function(){return this.defaultLaw?this.defaultLaw.request_note_html:""},publicBodySearch:function(){return this.publicBody?this.publicBody.name:this.publicbodyDefaultSearch},publicBodyListView:function(){return this.multiRequest?"multi":"actionList"},subject:{get:function(){return this.$store.state.subject},set:function(value){this.updateSubject(value)}},hasBody:function(){return this.body&&this.body.length>0},body:{get:function(){return this.$store.state.body},set:function(value){this.updateBody(value)}},allowFullText:function(){return!this.hideFullText&&this.publicBodies.length<1},fullText:{get:function(){return this.$store.state.fullText},set:function(value){this.updateFullText(value),value?(this.originalBody=this.body,this.body=this.letterStart+"\n"+this.body+"\n\n"+this.letterEndNoName):this.fullTextDisabled||(this.body=this.originalBody);var newLineCount=(this.body.match(/\n/g)||[]).length;this.bodyRows=Math.max(3,Math.min(newLineCount,10))}},first_name:{get:function(){return this.$store.state.user.first_name},set:function(value){this.updateFirstName(value)}},last_name:{get:function(){return this.$store.state.user.last_name},set:function(value){this.updateLastName(value)}},hasPublicBodies:function(){return this.publicBodies.length>0},publicBody:function(){return this.getPublicBodyByScope(this.pbScope)},publicBodies:function(){return this.getPublicBodiesByScope(this.pbScope)}},(0,_vuex.mapGetters)(["user","getPublicBodyByScope","getPublicBodiesByScope","defaultLaw","stepReviewReady","stepSelectPublicBody"])),methods:_extends({bodyChanged:function(e){this.fullText&&(this.fullTextDisabled=!0);for(var ta=document.querySelector("[name=body]");ta.scrollHeight>ta.clientHeight&&ta.rows<10;)ta.style.overflow="hidden",ta.rows+=1;ta.scrollHeight>ta.clientHeight&&(ta.style.overflow="auto"),this.bodyRows=ta.rows}},(0,_vuex.mapMutations)({setStepPublicBody:_mutation_types.SET_STEP_PUBLICBODY,setStepRequest:_mutation_types.SET_STEP_REQUEST,updateSubject:_mutation_types.UPDATE_SUBJECT,updateBody:_mutation_types.UPDATE_BODY,updateFullText:_mutation_types.UPDATE_FULL_TEXT,setUser:_mutation_types.SET_USER,updateFirstName:_mutation_types.UPDATE_FIRST_NAME,updateLastName:_mutation_types.UPDATE_LAST_NAME,setPublicBody:_mutation_types.SET_PUBLICBODY,setPublicBodies:_mutation_types.SET_PUBLICBODIES,cachePublicBodies:_mutation_types.CACHE_PUBLICBODIES}),(0,_vuex.mapActions)({setStepByURL:_mutation_types.SET_STEP_BY_URL})),components:{PublicbodyChooser:_publicbodyChooser2["default"],UserRegistration:_userRegistration2["default"],SimilarRequests:_similarRequests2["default"],ReviewRequest:_reviewRequest2["default"]}}},79:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_similar_requests_vue__=__webpack_require__(80),__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_similar_requests_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_similar_requests_vue__),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_22f61ee0_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_similar_requests_vue__=__webpack_require__(81),Component=__webpack_require__(3)(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_similar_requests_vue___default.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_22f61ee0_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_similar_requests_vue__.a,!1,null,null,null);__webpack_exports__["default"]=Component.exports},80:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_underscore=__webpack_require__(15),_vuex=__webpack_require__(2),_search=__webpack_require__(25),_i18nMixin2=function(obj){return obj&&obj.__esModule?obj:{"default":obj}}(__webpack_require__(16));exports["default"]={name:"similar-requests",props:["config","pbScope"],mixins:[_i18nMixin2["default"]],data:function(){return{similarRequests:[],searches:{},moreSimilarRequestsAvailable:!1}},created:function(){this.search=new _search.FroideSearch(this.config),this.$store.watch(this.$store.getters.getSubject,this.debouncedSearch),this.runSearch()},computed:_extends({hasResources:function(){return this.publicBody&&this.publicBody.url},hasSimilarRequests:function(){return this.similarRequests.length>0},searchUrl:function(){return this.config.url.search+"?q="+encodeURIComponent(this.subject)},debouncedSearch:function(){return(0,_underscore.debounce)(this.runSearch,1e3)},publicBody:function(){return this.getPublicBodyByScope(this.pbScope)}},(0,_vuex.mapGetters)(["getPublicBodyByScope","subject"])),methods:{runSearch:function(){var _this=this;this.subject&&(this.searches[this.subject]===undefined?(this.searches[this.subject]=!1,function(subject){_this.search.searchFoiRequests(subject).then(function(result){_this.moreSimilarRequestsAvailable=result.length>5,_this.similarRequests=result.slice(0,5),_this.searches[subject]=result})}(this.subject)):!1!==this.searches[this.subject]&&(this.similarRequests=this.searches[this.subject]))}}}},81:function(module,__webpack_exports__,__webpack_require__){"use strict";var esExports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.hasResources||_vm.hasSimilarRequests?_c("div",{staticClass:"card mb-3"},[_c("h5",{staticClass:"card-header"},[_vm._v("\n    "+_vm._s(_vm.i18n.similarExist)+"\n  ")]),_vm._v(" "),_c("div",{staticClass:"card-body"},[_c("div",{staticClass:"row"},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.hasResources,expression:"hasResources"}],staticClass:"col-md-6"},[_c("h6",[_vm._v("\n          "+_vm._s(_vm.i18n.relevantResources)+"\n        ")]),_vm._v(" "),_c("ul",[_vm.publicBody.url?_c("li",[_c("a",{attrs:{href:_vm.publicBody.url,target:"_blank",rel:"noopener"}},[_vm._v("\n              "+_vm._s(_vm.i18n.officialWebsite)+" "+_vm._s(_vm.publicBody.name)+"\n            ")])]):_vm._e()])]),_vm._v(" "),_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.hasSimilarRequests,expression:"hasSimilarRequests"}],staticClass:"col-md-6"},[_c("h6",[_vm._v("\n          "+_vm._s(_vm.i18n.similarRequests)+"\n        ")]),_vm._v(" "),_c("ul",{staticClass:"similar-requests"},_vm._l(_vm.similarRequests,function(req){return _c("li",[_c("a",{attrs:{href:req.url,target:"_blank"}},[_vm._v("\n              "+_vm._s(req.title)+"\n            ")])])})),_vm._v(" "),_vm.moreSimilarRequestsAvailable?_c("p",[_c("a",{attrs:{href:_vm.searchUrl,target:"_blank"}},[_vm._v("\n            "+_vm._s(_vm.i18n.moreSimilarRequests)+"\n          ")])]):_vm._e()])])])]):_vm._e()},staticRenderFns:[]};__webpack_exports__.a=esExports},82:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_user_registration_vue__=__webpack_require__(83),__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_user_registration_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_user_registration_vue__),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_528792f1_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_user_registration_vue__=__webpack_require__(84),Component=__webpack_require__(3)(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_user_registration_vue___default.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_528792f1_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_user_registration_vue__.a,!1,null,null,null);__webpack_exports__["default"]=Component.exports},83:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_vuex=__webpack_require__(2),_mutation_types=__webpack_require__(5),_i18nMixin2=function(obj){return obj&&obj.__esModule?obj:{"default":obj}}(__webpack_require__(16));exports["default"]={name:"user-registration",props:["config","formJson"],mixins:[_i18nMixin2["default"]],created:function(){null!==this.form.first_name.value&&this.updateFirstName(this.form.first_name.value),null!==this.form.last_name.value&&this.updateLastName(this.form.last_name.value),null!==this.form.user_email.value&&this.updateEmail(this.form.user_email.value),null!==this.form.address.value&&this.updateAddress(this.form.address.value),null!==this.form["private"].value&&this.updatePrivate(this.form["private"].value)},computed:_extends({_form:function(){return JSON.parse(this.formJson)},form:function(){return this._form.fields},errors:function(){return this._form.errors},authRequired:function(){return!(!this.errors||!this.errors.user_email)&&this.errors.user_email.some(function(er){return"auth_required"===er.code})},authRequiredUrl:function(){return this.config.url.loginSimple+this.email},first_name:{get:function(){return this.$store.state.user.first_name},set:function(value){this.updateFirstName(value)}},last_name:{get:function(){return this.$store.state.user.last_name},set:function(value){this.updateLastName(value)}},email:{get:function(){return this.$store.state.user.email},set:function(value){this.updateEmail(value)}},address:{get:function(){return this.$store.state.user.address},set:function(value){this.updateAddress(value)}},"private":{get:function(){return this.$store.state.user["private"]},set:function(value){this.updatePrivate(value)}}},(0,_vuex.mapGetters)(["user"])),methods:_extends({openLoginWindow:function(e){var url=e.target.href;this.popup=window.open(url,"popup","height=500,width=800,resizable=yes,scrollbars=yes"),this.popup.focus(),window.loggedInCallback=this.loggedInCallback},loggedInCallback:function(params){this.updateFirstName(params.first_name),this.updateLastName(params.last_name),this.updateAddress(params.address),this.updateEmail(params.email),this.updatePrivate(params["private"]),this.updateUserId(params.id);var csrfValue=params.csrf_token.match(/value=.(\w+)/)[1];if(csrfValue!==undefined)for(var csrfInputs=document.querySelectorAll('input[name="csrfmiddlewaretoken"]'),i=0;i<csrfInputs.length;i+=1)csrfInputs[i].value=csrfValue;this.popup&&this.popup.close(),window.loggedInCallback=undefined}},(0,_vuex.mapMutations)({updateFirstName:_mutation_types.UPDATE_FIRST_NAME,updateLastName:_mutation_types.UPDATE_LAST_NAME,updateAddress:_mutation_types.UPDATE_ADDRESS,updateEmail:_mutation_types.UPDATE_EMAIL,updatePrivate:_mutation_types.UPDATE_PRIVATE,updateUserId:_mutation_types.UPDATE_USER_ID}))}},84:function(module,__webpack_exports__,__webpack_require__){"use strict";var esExports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"card mb-3"},[_c("div",{staticClass:"card-body"},[_c("div",{staticClass:"form-group row"},[_c("label",{staticClass:"col-sm-3 col-form-label","class":{"text-danger":_vm.errors.user_email},attrs:{"for":"id_user_email"}},[_vm._v("\n        "+_vm._s(_vm.i18n.yourEmail)+"\n      ")]),_vm._v(" "),_c("div",{staticClass:"col-sm-9"},[_vm.user.id?_c("p",{staticClass:"form-control",attrs:{id:"email_address"}},[_vm._v("\n          "+_vm._s(_vm.user.email)+"\n        ")]):_c("div",[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.email,expression:"email"}],staticClass:"form-control","class":{"is-invalid":_vm.errors.user_email},attrs:{type:"email",name:"user_email",placeholder:_vm.form.user_email.placeholder},domProps:{value:_vm.email},on:{input:function($event){$event.target.composing||(_vm.email=$event.target.value)}}}),_vm._v(" "),_vm._l(_vm.errors.user_email,function(e){return _c("p",{staticClass:"text-danger"},[_vm._v(_vm._s(e.message))])}),_vm._v(" "),_vm.authRequired?_c("p",[_c("a",{staticClass:"btn btn-success",attrs:{id:"simple-login-link",href:_vm.authRequiredUrl},on:{click:function($event){$event.preventDefault(),_vm.openLoginWindow($event)}}},[_vm._v("\n              "+_vm._s(_vm.i18n.loginWindowLink)+"\n            ")])]):_vm._e()],2)])]),_vm._v(" "),_c("div",{staticClass:"form-group row"},[_c("label",{staticClass:"col-sm-3 col-form-label","class":{"text-danger":_vm.errors.address},attrs:{"for":"id_address"}},[_vm._v("\n        "+_vm._s(_vm.i18n.yourAddress)+"\n      ")]),_vm._v(" "),_c("div",{staticClass:"col-sm-9"},[_vm.user.id?_c("p",{staticClass:"form-control",attrs:{id:"email_address"}},[_vm._v("\n          "+_vm._s(_vm.user.email)+"\n        ")]):_c("div",[_c("textarea",{directives:[{name:"model",rawName:"v-model",value:_vm.address,expression:"address"}],staticClass:"form-control","class":{"is-invalid":_vm.errors.address},attrs:{name:"address",placeholder:_vm.form.address.placeholder},domProps:{value:_vm.address},on:{input:function($event){$event.target.composing||(_vm.address=$event.target.value)}}}),_vm._v(" "),_vm._l(_vm.errors.address,function(e){return _c("p",[_vm._v(_vm._s(e.message))])}),_vm._v(" "),_c("p",{staticClass:"help-block"},[_vm._v(_vm._s(_vm.form.address.help_text))])],2)])]),_vm._v(" "),_vm.config.settings.user_can_hide_web?_c("div",[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-md-8"},[_c("div",{staticClass:"checkbox"},[_c("label",[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm["private"],expression:"private"}],attrs:{id:"id_private",type:"checkbox",name:"private"},domProps:{checked:Array.isArray(_vm["private"])?_vm._i(_vm["private"],null)>-1:_vm["private"]},on:{change:function($event){var $$a=_vm["private"],$$el=$event.target,$$c=!!$$el.checked;if(Array.isArray($$a)){var $$i=_vm._i($$a,null);$$el.checked?$$i<0&&(_vm["private"]=$$a.concat([null])):$$i>-1&&(_vm["private"]=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}else _vm["private"]=$$c}}}),_vm._v("\n              "+_vm._s(_vm.form["private"].label)+"\n            ")]),_vm._v(" "),_c("br"),_vm._v(" "),_c("p",{staticClass:"help-block",domProps:{innerHTML:_vm._s(_vm.form["private"].help_text)}})])])])]):_vm._e()])])},staticRenderFns:[]};__webpack_exports__.a=esExports},85:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_review_request_vue__=__webpack_require__(88),__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_review_request_vue___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_review_request_vue__),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_c1b0b5d8_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_review_request_vue__=__webpack_require__(89),Component=__webpack_require__(3)(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_review_request_vue___default.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_c1b0b5d8_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_review_request_vue__.a,!1,function(ssrContext){__webpack_require__(86)},"data-v-c1b0b5d8",null);__webpack_exports__["default"]=Component.exports},86:function(module,exports,__webpack_require__){var content=__webpack_require__(87);"string"==typeof content&&(content=[[module.i,content,""]]),content.locals&&(module.exports=content.locals);__webpack_require__(8)("50f5d6c1",content,!0)},87:function(module,exports,__webpack_require__){(module.exports=__webpack_require__(6)(undefined)).push([module.i,".review-body-text[data-v-c1b0b5d8]{color:#333;border:1px solid #333;padding:.25em;height:14em;max-height:14em;overflow:auto;white-space:pre-wrap;word-wrap:break-word}.review-hints[data-v-c1b0b5d8]{margin-top:1rem}.review-hints .error[data-v-c1b0b5d8]{color:#ff002a}",""])},88:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function erx(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_vuex=__webpack_require__(2),_letterMixin2=function(obj){return obj&&obj.__esModule?obj:{"default":obj}}(__webpack_require__(27));exports["default"]={name:"review-request",props:["i18n","pbScope"],mixins:[_letterMixin2["default"]],computed:_extends({canSend:function(){return this.user.id||!this.hasErrors},hasErrors:function(){return this.errors.length>0},errors:function(){var _this=this,errors=[];this.subject&&0!==this.subject.length||errors.push(this.i18n.noSubject),this.body&&0!==this.body.length||errors.push(this.i18n.noBody);var needles=[];return this.fullText||(needles=[].concat(_toConsumableArray(needles),[[new RegExp(erx(this.i18n.greeting),"gi"),this.i18n.dontAddGreeting],[new RegExp(erx(this.i18n.kindRegards),"gi"),this.i18n.dontAddClosing]])),this.userRegex&&needles.push([this.userRegex,this.i18n.dontInsertName]),needles.forEach(function(params){params[0].test(_this.body)&&errors.push(params[1])}),errors},userRegex:function(){var regex=[];return this.user.first_name&&this.user.last_name&&regex.push(erx(this.user.first_name+" "+this.user.last_name)),this.user.first_name&&regex.push(erx(this.user.first_name)),this.user.first_name&&regex.push(erx(this.user.first_name)),0===regex.length?null:new RegExp(regex.join("|"),"gi")},publicBody:function(){return this.getPublicBodyByScope(this.pbScope)},publicBodies:function(){return this.getPublicBodiesByScope(this.pbScope)}},(0,_vuex.mapGetters)(["getPublicBodiesByScope","getPublicBodyByScope","subject","body","fullText"]))}},89:function(module,__webpack_exports__,__webpack_require__){"use strict";var esExports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"modal fade",attrs:{id:"step-review",tabindex:"-1",role:"dialog","aria-labelledby":"myModalLabel","aria-hidden":"true"}},[_c("div",{staticClass:"modal-dialog modal-lg"},[_c("div",{staticClass:"modal-content"},[_c("div",{staticClass:"modal-header"},[_c("h5",{staticClass:"modal-title"},[_vm._v("\n            "+_vm._s(_vm.i18n.reviewTitle)+"\n          ")]),_vm._v(" "),_vm._m(0)]),_vm._v(" "),_c("div",{staticClass:"modal-body"},[_c("dl",{staticClass:"message-meta"},[_c("dt",[_vm._v(_vm._s(_vm.i18n.reviewFrom))]),_vm._v(" "),_c("dd",[_vm._v("\n              "+_vm._s(_vm.user.first_name)+" "+_vm._s(_vm.user.last_name)+" <"+_vm._s(_vm.user.email)+">\n            ")]),_vm._v(" "),_c("dt",[_vm._v(_vm._s(_vm.i18n.reviewTo))]),_vm._v(" "),_vm.publicBodies.length>1?_c("dd",[_vm._v("\n              "+_vm._s(_vm.publicBodies.length)+" "+_vm._s(_vm.i18n.reviewPublicbodies)+"\n            ")]):_vm.publicBody?_c("dd",[_vm._v("\n              "+_vm._s(_vm.publicBody.name)+"\n            ")]):_c("dd",[_vm._v("\n              -\n            ")]),_vm._v(" "),_c("dt",[_vm._v(_vm._s(_vm.i18n.subject))]),_vm._v(" "),_c("dd",[_vm._v("\n              "+_vm._s(_vm.subject)+"\n            ")])]),_vm._v(" "),_vm.fullText?_c("div",[_c("div",{staticClass:"body-text review-body-text"},[_vm._v(_vm._s(_vm.body)+"\n"+_vm._s(_vm.letterSignatureName))])]):_c("div",[_c("div",{staticClass:"body-text review-body-text"},[_c("span",[_vm._v(_vm._s(_vm.letterStart))]),_vm._v(" "),_c("span",{staticClass:"highlight"},[_vm._v("\n"+_vm._s(_vm.body)+"\n")]),_vm._v(" "),_c("span",[_vm._v("\n"+_vm._s(_vm.letterEnd))])])]),_vm._v(" "),_c("ul",{staticClass:"review-hints"},[_c("li",[_vm._v(_vm._s(_vm.i18n.reviewSpelling))]),_vm._v(" "),_c("li",[_vm._v(_vm._s(_vm.i18n.reviewPoliteness))]),_vm._v(" "),_vm._l(_vm.errors,function(error){return _c("li",{staticClass:"error"},[_vm._v("\n              "+_vm._s(error)+"\n            ")])})],2)]),_vm._v(" "),_c("div",{staticClass:"modal-footer"},[_c("button",{staticClass:"btn","class":{"btn-secondary":_vm.canSend,"btn-primary":!_vm.canSend},attrs:{type:"button","data-dismiss":"modal"}},[_c("i",{staticClass:"fa fa-edit",attrs:{"aria-hidden":"true"}}),_vm._v("\n            "+_vm._s(_vm.i18n.reviewEdit)+"\n          ")]),_vm._v(" "),_vm.canSend?_c("button",{staticClass:"btn btn-primary",attrs:{type:"submit",id:"send-request-button"}},[_c("i",{staticClass:"fa fa-send",attrs:{"aria-hidden":"true"}}),_vm._v("\n            "+_vm._s(_vm.i18n.submitRequest)+"\n          ")]):_vm._e()])])])])},staticRenderFns:[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[_c("span",{attrs:{"aria-hidden":"true"}},[_vm._v("×")])])}]};__webpack_exports__.a=esExports},90:function(module,__webpack_exports__,__webpack_require__){"use strict";var esExports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"process-breadcrumbs-container"},[_c("div",{staticClass:"container"},[_c("div",{staticClass:"row"},[_c("ol",{staticClass:"process-breadcrumbs col-md-8"},[_c("li",{"class":{active:_vm.stepSelectPublicBody,done:_vm.stepReviewReady}},[_vm.hidePublicbodyChooser?_c("span",[_c("i",{staticClass:"fa fa-check-circle",attrs:{"aria-hidden":"true"}}),_vm._v("\n              Behörde wählen\n            ")]):_c("a",{attrs:{href:"#step-publicbody"},on:{click:_vm.setStepPublicBody}},[_c("i",{staticClass:"fa fa-check-circle",attrs:{"aria-hidden":"true"}}),_vm._v("\n              Behörde wählen\n            ")])]),_vm._v(" "),_c("li",{"class":{active:_vm.stepReviewReady}},[_vm.stepReviewReady?_c("a",{attrs:{href:"#step-request"},on:{click:_vm.setStepRequest}},[_c("i",{staticClass:"fa","class":{"fa-check-circle":_vm.stepReviewReady,"fa-check-circle-o":!_vm.stepReviewReady},attrs:{"aria-hidden":"true"}}),_vm._v("\n              Anfrage stellen\n            ")]):_c("span",[_c("i",{staticClass:"fa","class":{"fa-check-circle":_vm.stepReviewReady,"fa-check-circle-o":!_vm.stepReviewReady},attrs:{"aria-hidden":"true"}}),_vm._v("\n              Anfrage stellen\n            ")])]),_vm._v(" "),_c("li",[_vm.stepReviewReady?_c("a",{attrs:{href:"#step-review","data-toggle":"modal"}},[_c("i",{staticClass:"fa fa-check-circle-o",attrs:{"aria-hidden":"true"}}),_vm._v("\n              Prüfen\n            ")]):_c("span",[_c("i",{staticClass:"fa fa-check-circle-o",attrs:{"aria-hidden":"true"}}),_vm._v("\n              Prüfen\n            ")])])])])])]),_vm._v(" "),_c("div",{staticClass:"container"},[_vm._t("messages"),_vm._v(" "),_c("div",{staticClass:"row justify-content-lg-center"},[_c("div",{staticClass:"col-lg-12"},[_vm.stepSelectPublicBody?_c("fieldset",{staticClass:"mt-5",attrs:{id:"step-publicbody"}},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-lg-7"},[_vm._t("publicbody-legend-title"),_vm._v(" "),_vm._t("publicbody-help-text")],2)]),_vm._v(" "),_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-lg-8"},[_c("publicbody-chooser",{attrs:{name:"publicbody",defaultsearch:_vm.publicBodySearch,scope:_vm.pbScope,config:_vm.config,"list-view":_vm.publicBodyListView}})],1),_vm._v(" "),_c("div",{staticClass:"col-lg-4 small"},[_vm._t("publicbody-missing")],2)])]):_vm._e(),_vm._v(" "),_vm.stepReviewReady?_c("fieldset",{staticClass:"mt-3",attrs:{id:"step-request"}},[_vm._t("request-legend-title"),_vm._v(" "),_vm.multiRequest?_c("div",{staticClass:"publicbody-summary-container"},[_c("div",{staticClass:"publicbody-summary"},[_c("p",[_vm._v("\n                "+_vm._s(_vm.i18n._("toMultiPublicBodies",{count:_vm.publicBodies.length}))+"\n\n                "),_vm.hidePublicbodyChooser?_vm._e():_c("span",[_c("a",{staticClass:"pb-change-link badge badge-pill badge-primary ml-3",attrs:{href:"#step-publicbody"},on:{click:_vm.setStepPublicBody}},[_vm._v("\n                    "+_vm._s(_vm.i18n.change)+"\n                  ")])])])])]):_c("div",{staticClass:"publicbody-summary-container"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-lg-8 publicbody-summary"},[_c("p",[_vm._v("\n                  "+_vm._s(_vm.i18n._("toPublicBody",{name:_vm.publicBody.name}))+"\n                  "),_vm.hidePublicbodyChooser?_vm._e():_c("span",[_c("a",{staticClass:"pb-change-link badge badge-pill badge-primary ml-3",attrs:{href:"#step-publicbody"},on:{click:_vm.setStepPublicBody}},[_vm._v("\n                      "+_vm._s(_vm.i18n.change)+"\n                    ")])])])])]),_vm._v(" "),_vm.hasNotes?_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-lg-8"},[_c("div",{staticClass:"alert alert-warning",domProps:{innerHTML:_vm._s(_vm.requestNotes)}})])]):_vm._e()]),_vm._v(" "),_vm._l(_vm.publicBodies,function(pb){return _c("input",{attrs:{type:"hidden",name:"publicbody"},domProps:{value:pb.id}})}),_vm._v(" "),_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-md-8"},[_vm.nonFieldErrors.length>0?_c("div",{staticClass:"alert alert-danger"},_vm._l(_vm.nonFieldErrors,function(error){return _c("p",[_vm._v(_vm._s(error))])})):_vm._e(),_vm._v(" "),_c("div",{staticClass:"form-group"},[_c("label",{"class":{"text-danger":_vm.errors.subject},attrs:{"for":"id_subject"}},[_vm._v("\n                  "+_vm._s(_vm.i18n.subject)+"\n                ")]),_vm._v(" "),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.subject,expression:"subject"}],staticClass:"form-control","class":{"is-invalid":_vm.errors.subject},attrs:{type:"text",name:"subject",id:"id_subject",placeholder:_vm.form.subject.placeholder},domProps:{value:_vm.subject},on:{keydown:function($event){if(!("button"in $event)&&_vm._k($event.keyCode,"enter",13,$event.key))return null;$event.preventDefault()},input:function($event){$event.target.composing||(_vm.subject=$event.target.value)}}})])])]),_vm._v(" "),_c("label",{"class":{"text-danger":_vm.errors.subject},attrs:{"for":"id_subject"}},[_vm._v("\n            "+_vm._s(_vm.i18n.subject)+"\n          ")]),_vm._v(" "),_c("div",{staticClass:"card mb-3"},[_c("div",{staticClass:"card-body"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-md-4 order-md-2"},[_vm._t("requesthints")],2),_vm._v(" "),_c("div",{staticClass:"col-md-8 order-1"},[_vm.fullText?_vm._e():_c("div",{staticClass:"body-text"},[_vm._v(_vm._s(_vm.letterStart))]),_vm._v(" "),_c("textarea",{directives:[{name:"model",rawName:"v-model",value:_vm.body,expression:"body"}],staticClass:"form-control body-textarea","class":{"is-invalid":_vm.errors.body,attention:!_vm.hasBody},attrs:{name:"body",rows:_vm.bodyRows,placeholder:_vm.form.body.placeholder},domProps:{value:_vm.body},on:{keyup:_vm.bodyChanged,input:function($event){$event.target.composing||(_vm.body=$event.target.value)}}}),_vm._v(" "),_vm.user.id&&!_vm.hideFullText?_c("label",{staticClass:"small pull-right text-muted"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.fullText,expression:"fullText"}],attrs:{type:"checkbox",name:"full_text",disabled:_vm.fullTextDisabled},domProps:{checked:Array.isArray(_vm.fullText)?_vm._i(_vm.fullText,null)>-1:_vm.fullText},on:{change:function($event){var $$a=_vm.fullText,$$el=$event.target,$$c=!!$$el.checked;if(Array.isArray($$a)){var $$i=_vm._i($$a,null);$$el.checked?$$i<0&&(_vm.fullText=$$a.concat([null])):$$i>-1&&(_vm.fullText=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}else _vm.fullText=$$c}}}),_vm._v("\n                    "+_vm._s(_vm.form.full_text.label)+"\n                  ")]):_vm._e(),_vm._v(" "),_vm.fullText?_vm._e():_c("div",{staticClass:"body-text"},[_vm._v(_vm._s(_vm.letterEndShort))]),_vm._v(" "),_vm.letterSignature?_c("div",{staticClass:"body-text"},[_c("em",[_vm._v(_vm._s(_vm.letterSignature))])]):_vm._e(),_vm._v(" "),!_vm.letterSignature&&_vm.fullText?_c("div",{staticClass:"body-text"},[_vm._v(_vm._s(_vm.letterSignatureName))]):_vm._e()])]),_vm._v(" "),_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-md-8"},[_vm.user.id?_vm._e():_c("div",{staticClass:"form-group row"},[_c("div",{staticClass:"col","class":{"text-danger":_vm.usererrors.first_name}},[_c("label",{staticClass:"control-label","class":{"text-danger":_vm.usererrors.first_name},attrs:{"for":"id_first_name"}},[_vm._v("\n                        "+_vm._s(_vm.i18n.yourFirstName)+"\n                      ")]),_vm._v(" "),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.first_name,expression:"first_name"}],staticClass:"form-control","class":{"is-invalid":_vm.usererrors.first_name},attrs:{type:"text",name:"first_name",id:"id_first_name",placeholder:_vm.userform.first_name.placeholder},domProps:{value:_vm.first_name},on:{input:function($event){$event.target.composing||(_vm.first_name=$event.target.value)}}}),_vm._v(" "),_vm._l(_vm.usererrors.first_name,function(e){return _c("p",[_vm._v(_vm._s(e.message))])})],2),_vm._v(" "),_c("div",{staticClass:"col","class":{"text-danger":_vm.usererrors.last_name}},[_c("label",{staticClass:"control-label","class":{"text-danger":_vm.usererrors.last_name},attrs:{"for":"id_last_name"}},[_vm._v("\n                        "+_vm._s(_vm.i18n.yourLastName)+"\n                      ")]),_vm._v(" "),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.last_name,expression:"last_name"}],staticClass:"form-control","class":{"is-invalid":_vm.usererrors.last_name},attrs:{type:"text",name:"last_name",id:"id_last_name",placeholder:_vm.userform.last_name.placeholder},domProps:{value:_vm.last_name},on:{input:function($event){$event.target.composing||(_vm.last_name=$event.target.value)}}}),_vm._v(" "),_vm._l(_vm.usererrors.last_name,function(e){return _c("p",[_vm._v(_vm._s(e.message))])})],2)])]),_vm._v(" "),_vm.user.id?_vm._e():_c("div",{staticClass:"col-md-4 mt-4"},[_vm.userform.last_name.help_text?_c("small",{domProps:{innerHTML:_vm._s(_vm.userform.last_name.help_text)}}):_vm._e()])])])]),_vm._v(" "),_vm.user.id?_vm._e():_c("user-registration",{attrs:{"form-json":_vm.userFormJson,config:_vm.config}}),_vm._v(" "),_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-md-12"},[_vm._t("public"),_vm._v(" "),_vm._t("terms")],2)])],2):_vm._e(),_vm._v(" "),_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-md-12"},[_vm.showSimilar&&_vm.stepReviewReady?_c("similar-requests",{attrs:{pbScope:_vm.pbScope,config:_vm.config}}):_vm._e()],1)]),_vm._v(" "),_vm.stepReviewReady?_c("review-request",{attrs:{pbScope:_vm.pbScope,i18n:_vm.i18n}}):_vm._e(),_vm._v(" "),_vm.stepReviewReady?_c("button",{staticClass:"btn btn-primary",attrs:{type:"button",id:"review-button","data-toggle":"modal","data-target":"#step-review"}},[_c("i",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}}),_vm._v("\n          "+_vm._s(_vm.i18n.reviewRequest)+"\n        ")]):_vm._e(),_vm._v(" "),_vm.stepReviewReady&&_vm.user.id&&_vm.showDraft?_c("button",{staticClass:"btn btn-secondary",attrs:{type:"submit",name:"save_draft",value:"true"}},[_c("i",{staticClass:"fa fa-save",attrs:{"aria-hidden":"true"}}),_vm._v("\n          "+_vm._s(_vm.i18n.saveAsDraft)+"\n        ")]):_vm._e()],1)])],2)])},staticRenderFns:[]};__webpack_exports__.a=esExports}},[73])});
//# sourceMappingURL=makerequest.js.map